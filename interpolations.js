var cat_endpoints = {
	cute: {
		face:"M 40.802561,9.4619861 25.599771,71.333836 c -0.72238,27.694291 21.23032,49.850894 48.79036,64.346714 22.953989,11.04963 39.517369,13.05343 64.346719,13.78858 43.42496,-2.16843 67.53923,-17.50106 80.25662,-26.5165 10.17697,-8.22991 47.31039,-37.160224 41.7193,-66.468044 L 227.1252,1.6838157 196.36605,34.564276 c -45.66431,-7.02741 -86.63402,-4.02825 -124.804339,4.94975 z",
		eye:"m 54.499641,72.825046 c 1.71436,-14.71175 9.59916,-28.97393 30.60212,-30.9458 17.954019,-0.2879 26.363459,12.56279 34.534279,29.32609 -0.99832,4.43709 -3.05019,8.50019 -17.92175,15.2055 -10.070149,2.67432 -20.410209,3.72926 -31.428579,0.71428 -9.67436,-3.18278 -13.22366,-8.95509 -15.78607,-14.30007 z",
		pupil:"m 65.135861,49.700496 c -3.8946,10.09212 -4.1769,25.25808 -1.24282,34.67292 9.79839,5.9706 31.89756,6.65215 45.422649,-1.94096 3.8715,-10.00878 3.9206,-21.74476 -2.54622,-31.94454 -8.75741,-7.53092 -24.891119,-14.05489 -41.633609,-0.78742 z",
		nose:"m 124.24116,81.233326 27.22361,0 -15.55635,17.324121 z",
		mouth:"m 130.05918,104.58867 5.84924,-5.677673 6.72793,6.177673",
		reflection:"m 97.28571,50.803686 c -4.227129,-0.21972 -7.211539,2.6531 -7.142849,6.25 0.0687,3.5969 2.66392,6.3612 6.785709,6.42857 4.12179,0.0674 6.59836,-3.33835 6.60714,-6.07143 0.009,-2.73308 -2.02286,-6.38741 -6.25,-6.60714 z",
		eye2:"m 156.4318,69.036936 c 1.71436,-14.71175 9.59916,-28.97393 30.60212,-30.9458 17.95402,-0.2879 26.36346,12.56279 34.53428,29.32609 -0.99832,4.43709 -3.05019,8.50019 -17.92175,15.2055 -10.07015,2.67432 -20.41021,3.72926 -31.42858,0.71428 -9.67436,-3.18278 -13.22366,-8.95509 -15.78607,-14.30007 z",
		pupil2:"m 167.06802,45.912386 c -3.8946,10.09212 -4.1769,25.25808 -1.24282,34.67292 9.79839,5.9706 31.89756,6.65215 45.42265,-1.94096 3.8715,-10.00878 3.9206,-21.74476 -2.54622,-31.94454 -8.75741,-7.53092 -24.89112,-14.05489 -41.63361,-0.78742 z",
		reflection2:"m 199.21787,47.015576 c -4.22713,-0.21972 -7.21154,2.6531 -7.14285,6.25 0.0687,3.5969 2.66392,6.3612 6.78571,6.42857 4.12179,0.0674 6.59836,-3.33835 6.60714,-6.07143 0.009,-2.73308 -2.02286,-6.38741 -6.25,-6.60714 z",
		whisker1:"m 120,87.625116 c -7,1 -113.999999,2 -113.999999,2",
		whisker2:"M 120,94.625116 4.0000014,100.62512",
		whisker3:"m 122,100.62512 -98.999999,28",
		whisker4:"m 153,91.625116 122,-12",
		whisker5:"m 152,97.625117 124,1",
		whisker6:"m 151,105.62512 132,9",
	},
	not_cute: {
		face:"M 41.084232,9.8191101 25.881432,71.69096 c -0.72238,27.694287 21.23032,49.85089 48.79037,64.34671 22.953988,11.04963 39.517368,13.05343 64.346708,13.78858 43.42496,-2.16843 67.53923,-17.50106 80.25662,-26.5165 10.17697,-8.22991 47.31039,-37.16022 41.7193,-66.46804 L 227.40686,2.0409397 196.64771,34.9214 C 150.9834,27.89399 110.0137,30.89315 71.843382,39.87115 z",
		eye:"m 47.710242,71.76796 c 10.5532,-7.28713 17.23089,-8.59956 36.64286,-10.57143 17.954018,-0.2879 29.338328,0.85047 41.928558,7.71428 -7.18549,5.8513 -14.66719,8.10159 -19.2857,9.85715 -6.18106,1.26011 -27.738638,0.60794 -35.928578,-0.28572 -5.6085,-0.53113 -16.37531,-0.83897 -23.35714,-6.71428 z",
		pupil:"m 81.504212,61.5481 c -3.8946,10.09212 -1.34848,13.94438 0.70172,17.34881 7.32727,0.7062 13.796568,0.83709 18.729368,0.004 0.68953,-2.76095 3.03672,-6.54197 -0.77845,-17.27208 -10.572478,-0.27097 -10.874448,-1.17349 -18.652638,-0.0803 z",
		nose:"m 128.52283,103.59045 27.2236,0 -15.55635,17.32412 z",
		mouth:"m 125.34085,138.94579 14.84923,-17.67767 12.72793,17.67767",
		reflection:"m 93.567385,64.16081 c -4.227133,-0.21972 -7.211543,2.6531 -7.142853,6.25 0.0687,3.5969 2.66392,6.3612 6.785713,6.42857 4.121785,0.0674 6.598355,-3.33835 6.607135,-6.07143 0.009,-2.73308 -2.02286,-6.38741 -6.249995,-6.60714 z",
		eye2:"m 154.42857,69.45231 c 10.5532,-7.28713 17.23089,-8.59956 36.64286,-10.57143 17.95402,-0.2879 29.33833,0.85047 41.92856,7.71428 -7.18549,5.8513 -14.66719,8.10159 -19.2857,9.85715 -6.18106,1.26011 -27.73864,0.60794 -35.92858,-0.28572 -5.6085,-0.53113 -16.37531,-0.83897 -23.35714,-6.71428 z",
		pupil2:"m 188.22254,59.23245 c -3.8946,10.09212 -1.34848,13.94438 0.70172,17.34881 7.32727,0.7062 13.79657,0.83709 18.72937,0.004 0.68953,-2.76095 3.03672,-6.54197 -0.77845,-17.27208 -10.57248,-0.27097 -10.87445,-1.17349 -18.65264,-0.0803 z",
		reflection2:"m 200.28571,61.84516 c -4.22713,-0.21972 -7.21154,2.6531 -7.14285,6.25 0.0687,3.5969 2.66392,6.3612 6.78571,6.42857 4.12179,0.0674 6.59836,-3.33835 6.60714,-6.07143 0.009,-2.73308 -2.02286,-6.38741 -6.25,-6.60714 z",
		whisker4:"m 172.71428,90.93359 122,-12",
		whisker5:"m 171.71428,96.933587 124,1",
		whisker6:"m 170.71428,104.93359 132,9",
		whisker1:"m 116.71428,91.93359 c -7,1 -113.9999973,2 -113.9999973,2",
		whisker2:"M 116.71428,98.933587 0.7142828,104.93359",
		whisker3:"m 118.71428,104.93359 -98.999998,28",
	},
	order: ["face", "eye", "pupil", "reflection", "eye2", "pupil2", "reflection2", "nose", "mouth", "whisker1", "whisker2", "whisker3", "whisker4", "whisker5", "whisker6"],
	colors: {
		"face":"dark-gray",
		"eye":"white",
		"pupil":"black",
		"reflection":"white",
		"eye2":"white",
		"pupil2":"black",
		"reflection2":"white",
		"nose":"light-gray",
	}
}

colorcodes = {
	"dark-gray":"#666666",
	"white":"#ffffff",
	"black":"#000000",
	"light-gray":"#cccccc"
}
function attr(obj, c) {
	if (colorcodes[c]) {
		c = colorcodes[c];
	}
  obj.attr({"stroke":"black", "stroke-width":1, "fill":c});
}

function intermediate(from, to, pos) {
  var fromCurve = Raphael.path2curve(from);
  var toCurve = Raphael.path2curve(to);
  var diff = [];
  var attr = "path";
  //compute difference between paths and store in diff
  for (i = 0, ii = fromCurve.length; i < ii; i++) {
    diff[i] = [0];
    for (var j = 1, jj = fromCurve[i].length; j < jj; j++) {
      diff[i][j] = (toCurve[i][j] - fromCurve[i][j]);
    }
  }
  var S = " ";
  now = [];
  //compute new path string for intermediate image
  for (var i = 0, ii = fromCurve.length; i < ii; i++) {
    now[i] = [fromCurve[i][0]];
    for (var j = 1, jj = fromCurve[i].length; j < jj; j++) {
      now[i][j] = +fromCurve[i][j] + pos * diff[i][j];
    }
    now[i] = now[i].join(S);
  }
  return now.join(S);
}

function mydraw(label, endpoints, morphProp) {
	var endpoint1 = "cute";
	var endpoint2 = "not_cute";
	var paper = Raphael(label, 10000, 10000);
  var pieces = endpoints.order;
  var colors = endpoints.colors;
  for (var i=0; i<pieces.length; i++) {
    var p=pieces[i]
    var path1 = endpoints[endpoint1][p];
    if (endpoint2 == null) {
      var mypath = path1;
    } else {
      var path2 = endpoints[endpoint2][p];
      var interPath = intermediate(path1, path2, morphProp);
      var mypath = interPath;
    }
    console.log(mypath);
    var h = paper.path(mypath);
    if (colors[p]) {
	    attr(h, colors[p]);
	  }
  }
}


/*var paper = Raphael(0, 0, 10000, 10000);*/
mydraw("p1", cat_endpoints, 0);
mydraw("p2", cat_endpoints, 0.25);
mydraw("p3", cat_endpoints, 0.5);
mydraw("p4", cat_endpoints, 0.75);
mydraw("p5", cat_endpoints, 1);